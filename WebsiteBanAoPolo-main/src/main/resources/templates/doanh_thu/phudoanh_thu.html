<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Th·ªëng K√™ Doanh Thu</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container py-5">
  <h2 class="text-center mb-4">üìä Th·ªëng K√™ Doanh Thu Theo Ng√†y</h2>

  <!-- Th·∫ª th·ªëng k√™ -->
  <div id="statCards" class="row mb-4">
    <!-- S·∫Ω ƒë∆∞·ª£c ƒëi·ªÅn b·∫±ng JS -->
  </div>

  <!-- B·∫£ng th·ªëng k√™ chi ti·∫øt -->
  <div class="table-responsive">
    <table class="table table-bordered text-center">
      <thead>
      <tr>
        <th>Ng√†y</th>
        <th>S·ªë H√≥a ƒê∆°n</th>
        <th>T·ªïng S·∫£n Ph·∫©m</th>
        <th>SP Online</th>
        <th>SP C·ª≠a H√†ng</th>
        <th>Doanh Thu (‚Ç´)</th>
      </tr>
      </thead>
      <tbody id="detailTable">
      <!-- JS ƒë·ªï d·ªØ li·ªáu ·ªü ƒë√¢y -->
      </tbody>
    </table>
  </div>
</div>

<script th:inline="javascript">
  let dataNgay = /*[[${data}]]*/ [];

  function formatCurrency(value) {
    return value.toLocaleString("vi-VN", { style: "currency", currency: "VND" });
  }

  function loadDataNgay() {
    // T·ªïng h·ª£p d·ªØ li·ªáu
    const total = {
      doanhThu: 0,
      hoaDon: 0,
      sanPham: 0,
      sanPhamOnline: 0,
      sanPhamOffline: 0
    };

    dataNgay.forEach(d => {
      total.doanhThu += d.tongDoanhThu;
      total.hoaDon += d.tongSoHoaDon;
      total.sanPham += d.tongSanPhamBanRa;
      total.sanPhamOnline += d.soLuongSanPhamOnline;
      total.sanPhamOffline += d.soLuongSanPhamOffline;
    });

    // Card t·ªïng h·ª£p
    document.getElementById('statCards').innerHTML = `
      <div class="col-md-3 col-sm-6">
        <div class="card text-white bg-primary">
          <div class="card-body text-center">
            <h5 class="card-title">T·ªïng Doanh Thu</h5>
            <p class="stat-value">${formatCurrency(total.doanhThu)}</p>
          </div>
        </div>
      </div>
      <div class="col-md-2 col-sm-6">
        <div class="card text-white bg-success">
          <div class="card-body text-center">
            <h5 class="card-title">S·ªë H√≥a ƒê∆°n</h5>
            <p class="stat-value">${total.hoaDon}</p>
          </div>
        </div>
      </div>
      <div class="col-md-2 col-sm-6">
        <div class="card text-white bg-warning">
          <div class="card-body text-center">
            <h5 class="card-title">B√°n Online</h5>
            <p class="stat-value">${total.sanPhamOnline}</p>
          </div>
        </div>
      </div>
      <div class="col-md-2 col-sm-6">
        <div class="card text-white bg-dark">
          <div class="card-body text-center">
            <h5 class="card-title">B√°n T·∫°i C·ª≠a H√†ng</h5>
            <p class="stat-value">${total.sanPhamOffline}</p>
          </div>
        </div>
      </div>
      <div class="col-md-3 col-sm-6">
        <div class="card text-white bg-info">
          <div class="card-body text-center">
            <h5 class="card-title">T·ªïng SP B√°n</h5>
            <p class="stat-value">${total.sanPham}</p>
          </div>
        </div>
      </div>
    `;

    // B·∫£ng chi ti·∫øt theo ng√†y
    document.getElementById('detailTable').innerHTML = dataNgay.map(row => `
      <tr>
        <td>${(row.ngay)}</td>
        <td>${row.tongSoHoaDon}</td>
        <td>${row.tongSanPhamBanRa}</td>
        <td>${row.soLuongSanPhamOnline}</td>
        <td>${row.soLuongSanPhamOffline}</td>
        <td>${formatCurrency(row.tongDoanhThu)}</td>
      </tr>
    `).join('');
  }

  window.onload = loadDataNgay;
</script>
</body>
</html>
